# Supporting information for Random forest model to predict long-term seasonal nitrate and orthophosphate concentrations in British river reaches

- This resource provides the model code (notebooks) for predicting nitrate and orthophosphate concentrations at GB river reaches using random forest.
- Two nearly identical notebooks exist: one for nitrate and one for orthophosphate.
- Outputs are designed to be mapped onto the UK river network for visualization and post-analysis.

## Data sources and content

- Nitrate and orthophosphate readings
  - File: nitrate_readings.csv and orthophosphate_readings.csv
  - Contains aggregated and log-transformed seasonal readings from the Environmental Agency's Water Quality Archive.
  - Columns include SITE_ID (EA water quality site), SEASON (Spring, Summer, Autumn, Winter), and RESULT (log-transformed seasonal average, 2010â€“2020).
- Training features
  - File: training_features.csv
  - Contains features matched to all EA water quality sites, with SITE_ID and OBJECTID (river reach ID) plus a set of descriptors.
  - Features come from FEH catchment descriptors and Land Cover Map 2015 fractions (e.g., CCAR, HGHT, QALT, QASB, QASV, QB19, QBFI, QDPB, QDPS, QFAR, QFPD, QFPL, QLDP, QPRW, and various land-cover fractions such as ARABLE AND HORTICULTURE, GRASSLAND, URBAN, WATER, WOODLAND, etc.).
- River reach mapping
  - File: reaches_no_na.csv
  - Contains input features (matching the training_features columns) mapped to river reaches across Great Britain with no missing values.
  - Columns mirror training_features, with STATION as the river reach ID and other feature descriptors included.

## Data preparation and feature generation

- Features were generated by matching gridded datasets (FEH catchment characteristics and Land Cover Map 2015) to the UKCEH digital river network.
- Each water quality reading was matched to a corresponding river reach in the network.
- The two notebooks first train a random forest model using all available features to compute feature importances, then train a final model using only the selected features.

## Model training workflow

- Separate models for nitrate and orthophosphate
  - Each notebook trains a random forest model on the corresponding readings and features.
  - After initial training to obtain feature importances, a final model is trained with a reduced feature set to improve robustness and interpretability.
- Outputs are designed for downstream visualization by mapping predicted concentrations onto the river network.

## Outputs and data usage

- The predicted concentrations can be visualized and analyzed by mapping onto the Great Britain river network.
- The digital river network is not included in this submission due to licensing (separate dataset licensed by EIDC). The accompanying outputs are intended for post-analysis and visualization with that network.

## Licensing and access

- The digital river network dataset used for feature generation is licensed by EIDC and not included in this submission.
- Useful external resources referenced include the UKCEH digital river network, Land Cover Map 2015, FEH catchment descriptors, and the Environmental Agency Water Quality Archive.

## Useful links

- UKCEH digital river network of Great Britain (1:50,000)
- Land Cover Map 2015 (1km percentage aggregates)
- National river flow archive flood estimation handbook catchment descriptors
- Environmental Agency Water Quality Archive