# Supporting information for Random forest model to predict long-term seasonal nitrate and orthophosphate concentrations in British river reaches (https://doi.org/10.5285/ba208b6c-6f1a-43b1-867d-bc1adaff6445)

## Overview
- Provides the model codes (notebooks) used in the paper on river reach-level nutrient concentration estimation for Great Britain.
- Two Jupyter notebooks train random forest models: one for nitrate, one for orthophosphate.
- Processively, each notebook first trains a model with all features to obtain feature importances, then trains a final model using a subset of selected features.

## Data sources and structure
- Data sources:
  - Environmental Agency Water Quality Archive: seasonal readings (log-transformed) for nitrate and orthophosphate, 2010â€“2020.
  - FEH catchment descriptors and Land Cover Map 2015: used to generate input features.
  - UKCEH digital river network: used to map features to river reaches (not included in this submission due to licensing).
- Key files included:
  - nitrate_readings.csv
  - orthophosphate_readings.csv
  - training_features.csv
  - reaches_no_na.csv
  - nitrate_model_for_the_paper_including_feat_selection.ipynb
  - orthophosphate_model_for_the_paper_including_feat_selection.ipynb
- Data integration:
  - Features in training_features.csv and reaches_no_na.csv are generated by matching gridded datasets to the UKCEH river network.
  - Each water quality reading is matched to a GB river reach.
  - Outputs (predictions) can be mapped onto the river network for visualization and downstream analysis.

## Features and data mapping
- Input features include:
  - FEH catchment descriptors (e.g., CCAR, QALT, QASB, QASV, QBFI, QDPB, QDPS, QFAR, QFPD, QFPL, QLDP, QPRW, PROPWET, etc.).
  - Land cover fractions from Land Cover Map 2015 (e.g., ARABLE, COASTAL, GRASSLAND, HEATH/BOG, INLAND ROCK, URBAN, WATER, WOODLAND, plus UNKNOWN).
- Structure:
  - training_features.csv links site_id (EA water quality site) to OBJECTID (river reach ID) and includes the FEH/LCM-derived features.
  - reaches_no_na.csv contains river reaches across Great Britain with the same feature columns and no missing values, used for model predictions.
- Output readiness:
  - Results can be visualized on the GB river network (excluding the network data itself from this submission).

## Modeling approach
- Two nearly identical notebooks, one per nutrient (nitrate and orthophosphate).
- Workflow:
  - Train RF model on observed readings to obtain feature importances.
  - Train a final RF model using only the selected features (feature selection step).
- Target variable:
  - Nitrate: log-transformed seasonal readings (nitrate_readings.csv).
  - Orthophosphate: log-transformed seasonal readings (orthophosphate_readings.csv).

## Outputs and visualization
- Predictions are intended to be mapped to the GB river network for visualization and post-analysis.
- The digital river network is referenced but not included due to licensing; predictions nonetheless align with river-reach geographic units.

## Licensing and access
- The digital river network dataset is licensed by EIDC and not included in this submission.
- Useful links provided for data sources and network access (UKCEH network, FEH descriptors, LCM 2015, WQA, etc.).

## Useful links
- UKCEH digital river network of Great Britain (1:50,000): https://catalogue.ceh.ac.uk/documents/7d5e42b6-7729-46c8-99e9-f9e4efddde1d
- Land Cover Map 2015 (GB): https://doi.org/10.5285/7115bc48-3ab0-475d-84ae-fd3126c20984
- National river flow archive flood estimation handbook catchment descriptors: https://nrfa.ceh.ac.uk/feh-catchment-descriptors
- Environmental Agency Water Quality Archive: https://environment.data.gov.uk/water-quality/view/landing