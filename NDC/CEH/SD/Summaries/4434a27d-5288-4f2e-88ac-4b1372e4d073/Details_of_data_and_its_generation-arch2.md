# Details of data and its generation

- Virus production
  - DCV: a positive-sense RNA virus from Discistroviridae, isolated from D. melanogaster. To minimize genetic variation, single infectious clones were isolated via serial dilution.
  - Produced in Schneider's Drosophila line 2 (DL2) cells at 25°C with standard media and antibiotics.
  - The DCV strain was isolated from D. melanogaster collected in Charolles, France.
  - Serial dilutions (1:10^8 to 1:4×10^14) were applied to DL2 cells with 8 replicates per dilution; wells with clear cytopathic effects indicated infection.
  - The most diluted infected well was saved; a clone (B6A) was amplified and cultured; TCID50 of DCV was 6.32×10^9 infectious particles per ml.
  - Processed to pellet debris and store aliquots at -80°C; remaining material used for RNA extraction.

- Inoculating fly species
  - 19 species of Drosophilidae chosen across the phylogeny (including closely related groups).
  - Each lineage aimed for 10 passages per species (8 for D. montana due to reproduction issues).
  - Flies reared at 22°C; inoculations performed on 4–11 day old males with a sterile needle dipped in DCV solution.
  - Infections conducted in a randomized order; each passage involved inoculating roughly 11 flies per lineage (range 4–18).
  - Three days post-infection, flies were snap-frozen for viral load measurement by homogenization and RNA extraction; viral supernatants were stored for subsequent passages.
  - Each lineage underwent 10 passages per species (except noted exception), yielding an estimated 100–200 viral generations.

- Sequencing
  - cDNA synthesized with Superscript III using random hexamers.
  - DCV genomes amplified by eight overlapping PCRs covering positions 62–9050 bp (≈8989 bp; ~97% genome coverage).
  - PCR products pooled, cleaned, and prepared as Nextera XT libraries; 173 pooled libraries created.
  - Libraries sequenced on an Illumina MiSeq (v3) to generate 300 bp paired-end reads.

- Bioinformatics and variant calling
  - Quality control with FastQC; adapter/low-quality trimming with Trimmomatic (MINLEN 30, TRAILING 15, SLIDINGWINDOW 4:20, ILLUMINACLIP).
  - Ancestral DCV sequence generated by direct sequencing of PCR products and processed for high-quality reference.
  - Reads mapped to the reference using BWAMEM (with -M); 99.5% of reads had mapping quality >60.
  - BAM files processed with SAMtools; Read Groups added with Picard.
  - Variant calling with GATK UnifiedGenotyper (ploidy 100; stand_call_conf 30; downsample_to_coverage 1000) to detect low-frequency variants.

- Host phylogeny
  - Used a trimmed ultrametric phylogeny inferred from seven genes with BEAST.
  - The tree was pruned to the 19 host species used in the study; analyses aligned with this time-based phylogeny in R (APE package).

- Statistical analysis
  - SNP filtering: ancestral viral controls showed mean SNP frequency ~0.00092 and the highest frequency ~0.043; a SNP was considered if its frequency >0.05 in any evolved lineage; all three alleles were included for triallelic sites.
  - Parallel evolution within species: calculated FST between viral lineages using Hb (between-lineage differences) and Hw (within-lineage differences) per site; Hb and Hw averaged across sites to compute FST. A permutation test shuffled fly species labels to test whether lineages evolved in the same species were more similar than expected by chance.
  - SNP-level parallelism within species: repeated analyses for each SNP to identify signatures of parallel evolution.
  - Parallel evolution between species: pairwise FST between lineages from different host species was correlated with the genetic distance between the host species; significance assessed by permuting host labels on the Drosophila phylogeny (1000 permutations). SNP-level correlations were also assessed per site.
  - Data and outputs: sequence data available in NCBI SRA (SRP119720); BAMs, phylogeny, derived allele frequencies, and R scripts available in the NERC data repository to reproduce all figures and statistics.

- Data availability and reproducibility
  - Fastq files: NCBI SRA SRP119720.
  - BAM files, phylogeny, allele frequencies (biallelic and derived frequencies for triallelic sites), and replication-friendly R scripts provided in the NERC data repository for full reproducibility.