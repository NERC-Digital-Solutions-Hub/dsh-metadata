# Details of data and its generation

- Objective and scope
  - Study describes data generation and analysis for virus evolution of DCV across 19 Drosophilidae host species.
  - Provides procedural details, sequencing, bioinformatics, phylogenetic, and statistical analyses; aims to enable replication.

- Virus production
  - DCV: positive-sense RNA virus from Discistroviridae, isolated from D. melanogaster.
  - Single infectious clones prepared via serial dilution in DL2 cells to minimise genetic variation.
  - DCV grown in Schneider's Drosophila line 2 (DL2) cells at 25°C; TCID50 = 6.32 x 10^9 infectious particles/mL (Reed–Muench method).
  - Clone B6A selected for amplification; debris pelleted and stored at -80°C.

- Inoculating fly species
  - Virus passaged through 19 Drosophilidae species; aim for 10 replicates per species.
  - Species chosen across phylogeny; some closely related with recent common ancestry.
  - Flies reared at 22°C; males infected at 4–11 days old using sterile needles.
  - Inoculated replicates placed in vials, incubated 3 days post-infection, then snap-frozen for virus extraction.
  - Each lineage injected into mean ~11 flies per passage (range 4–18); 10 passages per lineage (D. montana: 8 due to stock reproduction failure).
  - Estimated overall viral generations: ~100–200.

- Sequencing
  - RNA from evolved lineages and ancestral DCV amplified in eight overlapping PCR reactions covering ~97% of the genome (positions 62–9050 bp; 8989 bp).
  - Illumina Nextera XT libraries prepared for each lineage; 173 pooled libraries sequenced on Illumina MiSeq v3 (600 cycles; 300 bp paired-end reads).
  - Ancestral starting virus amplified and sequenced for reference.

- Bioinformatics and variant calling
  - Quality control: FastQC; trimming with Trimmomatic (MINLEN 30, TRAILING 15, SLIDINGWINDOW 4:20, ILLUMINACLIP settings).
  - Ancestral reference sequence generated by PCR amplification and Sanger sequencing; aligned reads to this reference with BWA-MEM (−M option).
  - Post-processing: SAM/BAM processing with SAMtools; read groups added via Picard.
  - Variant calling: GATK UnifiedGenotyper with ploidy 100; stand_call_conf 30; downsampling to 1000x coverage.
  - Coverage and mapping quality reported; 99.5% of reads had mapping quality >60.

- Phylogeny and data organization
  - Host phylogeny: ultrametric time-based tree inferred from seven genes with BEAST; pruned to the 19 host species.
  - Data products and scripts: fastq files in NCBI SRA (SRP119720); BAMs, phylogeny, derived allele frequencies, and R analysis scripts in the NERC data repository.

- Statistical analyses
  - SNP filtering: ancestral replicates show mean SNP frequency ~0.000923; maximum ~0.043. Include SNPs with frequency >0.05 in any viral lineage; triallelic sites retained with all alleles.
  - Within-species parallel evolution: compute FST between virus lineages based on site heterozygosity (Hb, Hw); use permutation tests to compare within-species vs between-species FST.
  - Identify SNPs with signatures of parallel evolution within species via per-SNP permutation tests.
  - Between-species differentiation: correlate pairwise viral FST with genetic distance between host species; test significance via permutation of host labels on the Drosophila phylogeny.
  - Identify per-SNP correlations with host genetic distance via similar per-SNP permutations.

- Data and code accessibility
  - Sequencing data: NCBI SRA Accession SRP119720.
  - Processed data and analysis: BAM files, phylogeny, derived allele frequencies, and associated R scripts available in the NERC data repository; scripts reproduce figures and statistics from the submission.

- Tools and software referenced
  - FastQC, Trimmomatic, BWA-MEM, SAMtools, Picard, GATK UnifiedGenotyper, BEAST (v1.8.0), BEAUti (BEAST suite), R (with Ape package).