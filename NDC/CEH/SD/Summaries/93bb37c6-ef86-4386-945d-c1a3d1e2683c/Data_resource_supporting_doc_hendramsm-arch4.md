# Component model iterations for inputs into a multi-scale model describing the effect of host conditions on Hendra virus shedding, eastern Australia, 2008-2019

## Overview
- Datasets consist of model iteration objects and rasters used to run a multi-scale model predicting how host conditions affect Hendra virus shedding.
- Aim: determine if incorporating host-condition proxies improves predictions of virus shedding in space and time.
- 1,000 iterations are generated to quantify uncertainty; outputs feed into multi-scale prevalence predictions and are compared across eight model structures (three host-condition proxies plus a null roost-suitability model).

## Data assets and structure
- Three proxy model families: FoodShortageModels, NewRoostModels, RehabModels (each with 1,000 Iteration_*.Rdata files).
- Roost SDM iterations stored in RoostSDMIterations, containing BatRoostPredictions_YYYY.tif files (2007–2020; 14 files per folder; 1,000 folders).
- All model objects are usable with accompanying code to reproduce analyses (GitHub: hanlab-ecol/BatOneHealth).
- Input data and training data are hosted on FigShare (data and environmental features).

## File formats and naming
- Model outputs: .Rdata (GBM/XGBoost-based objects and hyperparameters for each model iteration).
- Roost SDM outputs: .TIF rasters (roost suitability 0–1).
- Naming conventions:
  - FoodShortageModels/Iteration_*.Rdata
  - NewRoostModels/Iteration_*.Rdata
  - RehabModels/Iteration_*.Rdata
  - RoostSDMIterations/Iteration_*/BatRoostPredictions_YYYY.tif (YYYY = 2007–2020)

## Spatial and temporal coverage
- Spatial resolution: 5 km; geographic bounds provided in GDA2020/SA Lambert and WGS84.
- Temporal extent:
  - Environmental training data spans 1996–2021 (monthly; 5 km grid cells and town polygons for different models).
  - Roost SDM predictions cover 2007–2020 (monthly).
  - Host-condition training periods: Rehab (2005–2020), NewRoost (2002–2019), Food Shortage (1998–2020).

## Input data and sources
- Environmental features grid (Table 1) from multiple sources:
  - Australian Gridded Climate Data (AGCD v1)
  - NOAA, BAS
  - Dynamic Land Cover Dataset (DLCD)
- Variables include temperature (tempMax, tempMin, tempDiff), precipitation (prec, prec_anom), NDVI, soil moisture, vapor pressure, solar exposure, PET, ONI, SAM, forest/urban/crop/pasture cover, etc.
- Training data by model:
  - Roost Distribution Model: 18,861 data points; roost occupancy (occupied/unoccupied); 1996–2021; 5 km resolution; sources NFFMP and ARS.
  - Bat Rehab: 10,150 data points; admissions to rehabilitation; 2005–2020; town polygons; WIRES.
  - New overwinter roosts: 195 data points; 2002–2019; 5 km; ARS.
  - Food Shortage: 267 data points; 1998–2020; single area; NECT.

## Modelling approach
- Platforms: R 4.3.2 with gbm and caret; FoodShortageModel uses XGBoost.
- Hyperparameters (selected via grid search):
  - Roost SDMIternations: eta 0.01, max depth 4, min observations in a node 2, 200,000 trees.
  - RehabModels: eta 0.0001, max depth 2, min obs per node 10, 150,000 trees.
  - NewRoostModels: eta 0.0001, max depth 2, min obs in a node 2, ~123,533 trees.
  - FoodShortageModels: eta 0.001, max depth 4, subsample 1, colsample_bytree 0.5, min_child_weight 1, gamma 0.5, 15,000 trees.
- Structure: compare eight model configurations combining three host-condition proxies (A: rehab, R: new roost, F: food shortage) and a null roost-suitability model; use maximum observed roost prevalence (MaxP = 66.6%) for scaling.

## Outputs and usage
- Outputs are combined to produce multi-scale predictions of Hendra shedding.
- Monthly landscape predictions generated by:
  - Computing host-condition probabilities per grid cell per month.
  - Forming P_x-t with C_xt and MaxP, then producing 1,000 roost-location realizations per month and averaging.
  - Excluding zero prevalences to avoid roost-absent bias.
- Bootstrapping to quantify uncertainty: input data resampled 1,000 times per host-condition model; each monthly map linked to a bootstrapped model variant.
- Outputs are not modified post-generation; designed for reproducibility and further analysis.

## Quality control and reproducibility
- Model fit evaluated using AUC.
- Full methodological details and references provided (included in supporting information and manuscript).
- Data and code accessibility:
  - FigShare for input data and training data.
  - GitHub (BatOneHealth) for runnable code to recreate models and analyses.

## Data governance and access
- Clear provenance and linkage between data assets, model objects, rasters, and code.
- Emphasis on discoverability (structured folders, naming conventions) and reusability (bootstrapping, multiple model structures, explicit hyperparameters).
- Outputs retain original formatting to support traceability and auditability.