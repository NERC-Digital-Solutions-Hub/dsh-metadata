# CP_Fish_HydrologyStats_Region.csv

## Overview
- Contains extracted flow statistics for NRFA gauging stations matched to nearby fish survey sites.
- Data pulled for daily flow records that cover the 12 months prior to each fish survey.
- Generated per region (Anglian, Midlands, North East, North West, Thames, Southern, South West) and linked to fish site data.

## Data content and structure
- One file per region: CP_Fish_HydrologyStats_Region.csv
- Number of rows/columns: variable by region; 100 variables total
- Key identifiers:
  - Fish_SiteID: unique fish site code (chempop project)
  - Fish_Easting, Fish_Northing: site coordinates
  - Fish_SurveyDate: date of fish survey
  - RF_Matched_Feature_ID: matched NRFA gauging station ID
- Regional linkage: region names include Anglian, Midlands, North East, North West, Thames, Southern, South West
- Data relationships: Fish_SiteID matches to other datasets (DataTable, SiteTable, chemical determinand)
- Missing data: coded as NA; less than 1% missing in matching period
- Dataset scope: gauging stations with sufficient daily records in the period of interest

## Provenance and authorship
- Source: NRFA flow archive (National River Flow Archive), hosted by CEH
- Generated by: Rachel Ainsworth (r.ainsworth@hull.ac.uk) and Virginie Keller (vke@ceh.ac.uk)
- License and rights: data and outputs governed by Â© UKCEH and related OS/public sector information licenses

## Methods and processing
- Spatial matching:
  - NRFA stations snapped to nearest river line using Euclidean distance
  - Buffer applied to convert points to polygons for network splitting
  - Distance along river network used to assign nearest NRFA station to each fish site
  - Arc GIS used (version 10.8+ or Pro) for matching; manual QA performed where automated matching failed
- Timeframe:
  - 12 months prior to each fish survey used for extraction
  - Full period of interest defined as 1974/05/20 to 2019/03/29
- Statistics calculated:
  - Period of record statistics (full period of interest):
    - mean, q50 (median), sd, cov (coefficient of variation), q5.mean, q95.mean
  - Threshold statistics for 3-, 6-, and 12-month preceding periods (precper or POI):
    - threshold (discharge quantile at 5%, 25%, 75%, 95%)
    - duration_exceeded (days the threshold was exceeded, as a proportion of the preceding period)
    - n_exceedences (number of exceedance events, as a proportion of days in the preceding period)
    - avg_patch_length (average duration of exceedance events)
- terminology:
  - Exceedance defined relative to the specified percentile (5%, 25%, 75%, 95%)
  - Periods labeled as 3M, 6M, 12M with precper or POI indicators
- Tools and software:
  - Arc GIS (map or Pro) for visualization
  - Python 3 with modules: os, shapely, pandas, geopandas, matplotlib, numpy, network, warnings
- Quality assurance:
  - Site matching manually verified due to issues with automated matching code
  - Overall data quality controlled to ensure reliable linkage between fish sites and flow data

## Data specifics by region
- Columns:
  - Fish_SiteID, Fish_Easting, Fish_Northing, Fish_SurveyDate, RF_Matched_Feature_ID
  - Period of record statistics: mean, q50, sd, cov, q5.mean, q95.mean
  - Threshold statistics: n_Months_period_P_stat (e.g., 3M_precper_5th_threshold, etc.)
- Column naming convention:
  - {n}_{period}_{P}_{stat}, where n = 3M, 6M, 12M; period = precper or POI; P = 5%, 25%, 75%, 95%; stat = threshold, duration_exceeded, n_exceedences, avg_patch_length

## How to use and interpret
- Data can be linked to fish survey data via Fish_SiteID for integrated analyses across hydrology and fish ecology
- Suitable for creating dashboards or reports that allow self-service exploration of flow statistics around fish sampling sites
- Can inform understanding of hydrological context influencing fish surveys and assist in policy or management discussions

## Usage notes and limitations
- Only NRFA stations with adequate daily records in the period of interest were included; data completeness is high but not perfect (NA used where applicable)
- Automated matching had errors; manual verification was required to ensure correct site-station linkage
- Full reproducibility requires Arc GIS for spatial matching and the specified Python stack for data processing

## Licensing and access
- Data governed by the CP_Fish_HydrologyStats framework under UKCEH licensing; GIS data may include Crown copyright and OS/Public Sector information
- Users should reference the authors and CEH NRFA data when utilizing outputs for research or reporting